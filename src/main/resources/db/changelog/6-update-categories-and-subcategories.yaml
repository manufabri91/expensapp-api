databaseChangeLog:
  - changeSet:
      id: 6.1-add-readonly-and-type-columns
      author: manuelnfabri
      changes:
        - addColumn:
            tableName: categories
            columns:
              - column:
                  name: readonly
                  type: boolean
                  defaultValueBoolean: false
              - column:
                  name: type
                  type: int
                  defaultValueNumeric: 1
                  constraints:
                    nullable: false
        - addColumn:
            tableName: subcategories
            columns:
              - column:
                  name: readonly
                  type: boolean
                  defaultValueBoolean: false

  - changeSet:
      id: 6.2-update-existing-categories-type
      author: manuelnfabri
      changes:
        - update:
            tableName: categories
            columns:
              - column:
                  name: type
                  valueNumeric: 1

  - changeSet:
      id: 6.3-add-system-user
      author: manuelnfabri
      changes:
        - sql:
            comment: |
              Insert system user for configuration purposes
            sql: |
              INSERT INTO users (id, email, firstname, lastname, username)
              VALUES ('system', 'system', 'system', 'system', 'system');

  - changeSet:
      id: 6.4-add-transfer-category-and-subcategories
      author: manuelnfabri
      changes:
        - sql:
            comment: |
              Insert a read-only TRANSFER category and two read-only subcategories for IN and OUT
            sql: |
              INSERT INTO categories (name, iconname, color, owner, type, readonly, deleted, createdat, updatedat, createdby, updatedby)
              VALUES ('TRANSFER.CATEGORY', 'transfer', '#3f83f8', 'system', 2, true, false, now(), now(), 'system', 'system');

              -- Get the id of the TRANSFER category and insert subcategories referencing it
              INSERT INTO subcategories (name, parentcategory, readonly, deleted, createdat, updatedat, createdby, updatedby, owner)
              SELECT 'TRANSFER.IN.SUBCATEGORY', id, true, false, now(), now(), 'system', 'system', 'system'
              FROM categories WHERE name = 'TRANSFER.CATEGORY';

              INSERT INTO subcategories (name, parentcategory, readonly, deleted, createdat, updatedat, createdby, updatedby, owner)
              SELECT 'TRANSFER.OUT.SUBCATEGORY', id, true, false, now(), now(), 'system', 'system', 'system'
              FROM categories WHERE name = 'TRANSFER.CATEGORY';
